const cards=["register.html","come.html","whenwhere.html","submit.html","hellocon.html","coc.html"];async function main(){loadcss("cards.css");const toBehtml=importhtml("cards.html"),cardtemplates=await toBehtml,mastercard=$(".mastercard",cardtemplates).content.children[0];fetchCards(cards).map(parseHtml).map(card=>plugintemplate(card,mastercard)).forEach(card=>listenExpandcard(card)).forEach(globalHandler.addTOC).forEach(globalHandler.addcard).forEach(scrollHash)}main();function fetchCards(cardmds){return new Promises(cardmds.map(card=>fetch("cards/"+card).then(res=>res.text())))}function plugintemplate(card,mastercard){const target=mastercard.cloneNode(!0),[h2,brief,pimg,...details]=card.children,img=pimg.firstElementChild,thumb=$(".thumbnail",target);$$("iframe",card).forEach(hideiframe),Object.assign($(".cardtitle",target),{textContent:h2.textContent}),Object.assign($(".dummy",target),{id:h2.id}),img.setAttribute("crossOrigin","anonymous"),thumb.appendChild(img),$(".brief",target).innerHTML=brief.innerHTML;const detailsTarget=$(".details",target);return details.forEach(d=>detailsTarget.appendChild(d)),target.style.maxHeight=(.9*innerHeight).toString()+"px",target}function listenExpandcard(card){const expand=$(".expand",card),ObsCardTransition=Rx.Observable.fromEvent(card,"transitionend",{passive:!0}).debounceTime(5);return expand.subscribe("click",ev=>{const iframes=$$("iframe",card);mobile||iframes.forEach(showiframe),requestAnimationFrame(()=>{card.classList.toggle("expanded"),mobile||ObsCardTransition.first().subscribe(()=>{expand.parentNode.scrollIntoView({behavior:"smooth"})})})})}function scrollHash(card){const dummy=$(".dummy",card);dummy.id===location.hash.slice(1)&&window.addEventListener("load",()=>{console.log("comparing hash"),requestAnimationFrame(()=>dummy.scrollIntoView())})}