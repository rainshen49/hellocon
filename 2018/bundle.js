function $(selector,container=document){return container.querySelector(selector)}function $$(selector,container=document){return Array.from(container.querySelectorAll(selector))}function loadcss(url){const link=document.createElement("link");return link.href=url,link.rel="stylesheet",document.head.appendChild(link),new Promise((yes,no)=>{link.onload=yes,link.onerror=no})}function importhtml(url){return fetch(url).then(res=>res.text()).then(parseHtml)}function parseHtml(info){const dummyroot=document.createElement("div");return dummyroot.innerHTML=info,dummyroot}function hideiframe(element){element.dataset.src=element.src,element.src="//about:blank"}function showiframe(element){element.src!==element.dataset.src&&element.setAttribute("src",element.dataset.src)}class Promises extends Promise{constructor(promises){Array.isArray(promises)?(super((yes,no)=>{Promise.all(promises).then(yes).catch(no)}),this.promises=promises):super(promises)}map(ftn){return new Promises(this.promises.map(promise=>promise.then(ftn)))}forEach(ftn){return new Promises(this.promises.map(promise=>promise.then(res=>(ftn(res),res))))}}Object.assign(EventTarget.prototype,{subscribe(event,ftn){const self=this;return this.addEventListener(event,ftn),{unsubscribe(){self.removeEventListener(event,ftn)}}}});const mobile=window.innerWidth<=768;function getSharedElements(container=document.body){const splash=$("#splash",container),content=$(".content",container),reload=$("#reload",container),nav=$("#nav",container);return{splash:splash,content:content,reload:reload,nav:nav,ham:$("#ham",nav),toc:$("#toc",container),modalbg:$(".modalbg",container),socialmedia:$("#socialmedia",container)}}function getContainerActions(DOM){initializeNav(DOM),initializeReload(DOM),initializeTOC(DOM,toggleTOC);function toggleTOC(open){const cl=DOM.toc.classList;void 0===open&&(open=cl.contains("detached")),requestAnimationFrame(()=>{open&&cl.contains("detached")?(cl.remove("detached"),setModal(!0)):open||cl.contains("detached")||(cl.add("detached"),setModal(!1))})}DOM.modalbg.subscribe("touchmove",ev=>ev.preventDefault());function setModal(on=!1){requestAnimationFrame(()=>{on?(DOM.modalbg.classList.remove("detached"),document.body.classList.add("modalopen")):(DOM.modalbg.classList.add("detached"),document.body.classList.remove("modalopen"))})}return{addTOC:function(target){const a=document.createElement("a"),h2=$(".cardtitle",target),dummy=$(".dummy",target);Object.assign(a,{textContent:h2.textContent,href:"/#"+dummy.id,className:"navitem"}),a.subscribe("click",()=>{toggleTOC(!1)}),DOM.toc.appendChild(a)},addcard:function(card){DOM.content.appendChild(card)},setModal:setModal}}function initializeTOC(DOM,toggleTOC){DOM.modalbg.subscribe("click",()=>toggleTOC(!1)),DOM.ham.subscribe("click",toggleTOC)}function initializeNav(DOM){const{nav:nav,splash:splash}=DOM,navheight=nav.getBoundingClientRect().height;Rx.Observable.fromEvent(window,"scroll",{passive:!0}).startWith(0).map(()=>splash.getBoundingClientRect().bottom-navheight).observeOn(Rx.Scheduler.animationFrame).do(location=>{location<0!==nav.classList.contains("ontop")&&nav.classList.toggle("ontop")}).subscribe();nav.subscribe("touchmove",ev=>ev.preventDefault())}function initializeReload(DOM){const{reload:reload,splash:splash}=DOM,scrollthreshold=Math.floor(reload.getBoundingClientRect().bottom),ObsSplashTouchStart=Rx.Observable.fromEvent(splash,"touchstart",{passive:!0}),ObsSplashTouchMove=Rx.Observable.fromEvent(splash,"touchmove",{passive:!0}),ObsSplashTouchEnd=Rx.Observable.fromEvent(splash,"touchend",{passive:!0}),rlclassList=(ObsSplashTouchStart.do(()=>{const touchstart=ObsReloadWaiting.subscribe(),touchend=ObsReloadConfirm.subscribe(()=>{touchend.unsubscribe(),touchstart.unsubscribe()})}).subscribe(),reload.classList),ObsReloadWaiting=ObsSplashTouchMove.observeOn(Rx.Scheduler.animationFrame).do(()=>{scrollY<0?(rlclassList.remove("detached"),scrollY<-scrollthreshold?rlclassList.add("activated"):rlclassList.remove("activated")):rlclassList.add("detached")}),ObsReloadConfirm=ObsSplashTouchEnd.observeOn(Rx.Scheduler.animationFrame).do(()=>{scrollY>=-scrollthreshold?rlclassList.add("detached"):(rlclassList.add("active"),requestAnimationFrame(()=>window.location.reload()))})}async function main(){window.addEventListener("load",function(){requestAnimationFrame(()=>{DOM.reload.classList.remove("active"),DOM.reload.classList.add("detached")})})}const DOM=getSharedElements(document.body),globalHandler=getContainerActions(DOM);main();const cards=["register.html","come.html","whenwhere.html","submit.html","hellocon.html","coc.html"],cardloaded=async function(){const toBehtml=importhtml("cards.html"),cardtemplates=await toBehtml,mastercard=$(".mastercard",cardtemplates).content.children[0];(await fetchCards(cards).map(parseHtml).map(card=>plugintemplate(card,mastercard)).forEach(card=>listenExpandcard(card))).forEach(card=>{globalHandler.addTOC(card),globalHandler.addcard(card),scrollHash(card)})}();function fetchCards(urls){const cardsJSONRes=fetch("./cards/cards.json").then(res=>res.json());return new Promises(urls.map(url=>cardsJSONRes.then(cardsjson=>cardsjson.hasOwnProperty(url)?cardsjson[url]:fetch("./cards/"+url).then(res=>res.text()))))}function plugintemplate(card,mastercard){const target=mastercard.cloneNode(!0),[h2,brief,pimg,...details]=card.children,img=pimg.firstElementChild,thumb=$(".thumbnail",target);$$("iframe",card).forEach(hideiframe),Object.assign($(".cardtitle",target),{textContent:h2.textContent}),Object.assign($(".dummy",target),{id:h2.id}),img.setAttribute("crossOrigin","anonymous"),thumb.appendChild(img),$(".brief",target).innerHTML=brief.innerHTML;const detailsTarget=$(".details",target);return details.forEach(d=>detailsTarget.appendChild(d)),target.style.maxHeight=(.9*innerHeight).toString()+"px",target}function listenExpandcard(card){const expand=$(".expand",card),ObsCardTransition=Rx.Observable.fromEvent(card,"transitionend",{passive:!0}).debounceTime(5);return expand.subscribe("click",ev=>{const iframes=$$("iframe",card);mobile||iframes.forEach(showiframe),requestAnimationFrame(()=>{card.classList.toggle("expanded"),mobile||ObsCardTransition.first().subscribe(()=>{expand.parentNode.scrollIntoView({behavior:"smooth"})})})})}function scrollHash(card){const dummy=$(".dummy",card);dummy.id===location.hash.slice(1)&&window.addEventListener("load",()=>{console.log("comparing hash"),requestAnimationFrame(()=>dummy.scrollIntoView())})}!async function(){const sponsors=$(".sponsors"),last=sponsors.lastElementChild,first=sponsors.firstElementChild,imgs=$$("img",sponsors);await cardloaded,await new Promises(imgs.map(img=>(img.src=img.dataset.src,new Promise((yes,no)=>{img.onload=yes,img.onerror=(()=>{yes(),console.error(img.src,"error")})})))),last.getBoundingClientRect().right-first.getBoundingClientRect().left>sponsors.getBoundingClientRect().width&&carousel(sponsors)}();function carousel(sponsors){const first=sponsors.firstElementChild;function scroll(lastx,dir){sponsors.scrollBy(dir,0);const{x:x}=first.getBoundingClientRect();lastx===x?setTimeout(()=>requestAnimationFrame(()=>scroll(x,-dir)),2e3):requestAnimationFrame(()=>scroll(x,dir))}requestAnimationFrame(()=>scroll(first.getBoundingClientRect(),1))}