const mobile=window.innerWidth<=768;function getSharedElements(e=document.body){const t=$("#splash",e),o=$(".content",e),a=$("#reload",e),n=$("#nav",e);return{splash:t,content:o,reload:a,nav:n,ham:$("#ham",n),toc:$("#toc",e),modalbg:$(".modalbg",e),socialmedia:$("#socialmedia",e),filechooser:$("#filechooser",e)}}function getContainerActions(e){initializeNav(e),initializeReload(e),initializeTOC(e,t);function t(t){const a=e.toc.classList;void 0===t&&(t=a.contains("detached")),requestAnimationFrame(()=>{t&&a.contains("detached")?(a.remove("detached"),o(!0)):t||a.contains("detached")||(a.add("detached"),o(!1))})}e.modalbg.subscribe("touchmove",e=>e.preventDefault());function o(t=!1){requestAnimationFrame(()=>{t?(e.modalbg.classList.remove("detached"),document.body.classList.add("modalopen")):(e.modalbg.classList.add("detached"),document.body.classList.remove("modalopen"))})}return{addTOC:function(o){const a=document.createElement("a"),n=$("h2",o);Object.assign(a,{textContent:n.textContent,href:"#"+n.id,className:"navitem"}),a.subscribe("click",e=>t(!1)),e.toc.appendChild(a)},setModal:o,addcard:function(t){e.content.appendChild(t)},redirectTOC:function(t,o){const a=$("h2",o),n=$('a[href="#'+t+'"]',e.toc);n.href="#"+a.id,n.textContent=a.textContent,console.log("changing",t,"to",a.id)}}}function initializeTOC(e,t){e.modalbg.subscribe("click",()=>t(!1)),e.ham.subscribe("click",t)}function initializeNav(e){const{nav:t,splash:o}=e,a=t.getBoundingClientRect().height;Rx.Observable.fromEvent(window,"scroll",{passive:!0}).startWith(0).map(()=>o.getBoundingClientRect().bottom-a).observeOn(Rx.Scheduler.animationFrame).do(e=>{e<0!==t.classList.contains("ontop")&&t.classList.toggle("ontop")}).subscribe();t.subscribe("touchmove",e=>e.preventDefault())}function initializeReload(e){const{reload:t,splash:o}=e,a=Math.floor(t.getBoundingClientRect().bottom),n=Rx.Observable.fromEvent(o,"touchstart",{passive:!0}),i=Rx.Observable.fromEvent(o,"touchmove",{passive:!0}),s=Rx.Observable.fromEvent(o,"touchend",{passive:!0}),c=(n.do(()=>{const e=d.subscribe(),t=l.subscribe(()=>{t.unsubscribe(),e.unsubscribe()})}).subscribe(),t.classList),d=i.observeOn(Rx.Scheduler.animationFrame).do(()=>{scrollY<0?(c.remove("detached"),scrollY<-a?c.add("activated"):c.remove("activated")):c.add("detached")}),l=s.observeOn(Rx.Scheduler.animationFrame).do(()=>{scrollY>=-a?c.add("detached"):(c.add("active"),requestAnimationFrame(()=>window.location.reload()))})}async function main(){applypreloadedstyles();const e=loadscript("cards.js","");await e,requestAnimationFrame(()=>{DOM.reload.classList.remove("active"),DOM.reload.classList.add("detached")})}const DOM=getSharedElements(document.body),globalHandler=getContainerActions(DOM);main();